(self["webpackChunkfe_web_pw_wizard"] = self["webpackChunkfe_web_pw_wizard"] || []).push([["node_modules_bper_npm-core_fesm2020_bper-npm-core-tealium-utag_mjs-_d5241"],{

/***/ 27536:
/*!*****************************************************************************!*\
  !*** ./node_modules/@bper/npm-core/fesm2020/bper-npm-core-tealium-utag.mjs ***!
  \*****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   TEALIUM_INIT_CFG: () => (/* binding */ TEALIUM_INIT_CFG),
/* harmony export */   TealiumUtagModule: () => (/* binding */ TealiumUtagModule),
/* harmony export */   TealiumUtagService: () => (/* binding */ TealiumUtagService)
/* harmony export */ });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ 63457);
/* harmony import */ var _bper_npm_core_user_data__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @bper/npm-core/user-data */ 28890);



const TEALIUM_INIT_CFG = new _angular_core__WEBPACK_IMPORTED_MODULE_0__.InjectionToken('Init configuration for tealium service');
const DEFAULT_FROM_PARAM = 'body';
class TealiumUtagService {
  // Typically set "noview" flag (no first page automatic view event) to true for Single Page Apps (SPAs)
  constructor(_userDataService, cfg) {
    this._userDataService = _userDataService;
    /** property per definire la provenienza per l'accesso in pagina. Resettato al lancio della funzione view */
    this._navigatedFrom = DEFAULT_FROM_PARAM;
    this._scriptSrc = cfg.scriptSrc;
    this._isProduction = cfg.isProduction;
    window.utag_cfg_ovrd = {
      noview: true
    };
    window.utag_data = {};
  }
  // Generic script loader with callback
  _getScript(src, callback) {
    const d = document;
    const fn = () => {};
    const o = {
      callback: callback || fn
    };
    let s;
    let t;
    if (typeof src === 'undefined') {
      return;
    }
    s = d.createElement('script');
    s.language = 'javascript';
    s.type = 'text/javascript';
    s.async = 1;
    s.charset = 'utf-8';
    s.src = src;
    if (typeof o.callback === 'function') {
      if (d.addEventListener) {
        s.addEventListener('load', () => {
          o.callback();
        }, false);
      } else {
        // old IE support
        s.onreadystatechange = function () {
          if (this.readyState === 'complete' || this.readyState === 'loaded') {
            this.onreadystatechange = null;
            o.callback();
          }
        };
      }
    }
    t = d.getElementsByTagName('script')[0];
    t.parentNode.insertBefore(s, t);
  }
  _track(tealiumEvent, data) {
    if (this._scriptSrc === '') {
      console.error('[TEALIUM] Config not set.');
      return;
    }
    if (!this._page_id) {
      console.error('[TEALIUM] Page id not set.');
      return;
    }
    const obj = {
      ...data,
      page_id: data?.page_id || this._page_id_child || this._page_id
    };
    if (!this._isProduction) {
      console.log('[TEALIUM::ACTION] - ', `${tealiumEvent}::${JSON.stringify(obj)}`);
      return;
    }
    if (window.utag === undefined) {
      this._getScript(this._scriptSrc, () => {
        window.utag[tealiumEvent](obj);
      });
    } else {
      window.utag[tealiumEvent](obj);
    }
  }
  /**
   *    Funzione per tracciamento data layer/pagine visitate
   *
   *      @param data: UTagViewDataModel
   */
  view(data) {
    try {
      const utente_codice_hb = this._userDataService.userData?.homeBankingAccountCode || '';
      const utente_pacchetto = this._userDataService.userProduct?.code || '';
      const utente_abi_banca = this._userDataService.userData?.abi || '05387';
      const from = this._navigatedFrom;
      this._track('view', {
        ...data,
        utente_abi_banca,
        utente_codice_hb,
        utente_pacchetto,
        from
      });
      /** Reset from dopo l'azione di view */
      this._navigatedFrom = DEFAULT_FROM_PARAM;
    } catch (err) {
      console.error(err);
      throw new Error('[TEALIUM::ERROR] Data view not valid');
    }
  }
  /**
   *    Funzione per tracciamento eventi
   *
   *      @param data: UTagLinkDataModel
   */
  link(data) {
    if (!data) return;
    try {
      this._track('link', {
        ...data
      });
    } catch (err) {
      console.error(err);
      throw new Error('[TEALIUM][ERROR] link');
    }
  }
  /**
   * Funzione per settare l'id della pagina in cui ci si trova
   *
   * @param pageId  Page id della pagina caricata
   *
   * @return        Ritorna l'istanza del service
   */
  setPageId(pageId) {
    this._page_id = pageId;
    return this;
  }
  /**
   * Funzione per recuperare l'id della pagina in cui ci si trova
   *
   * @return        Ritorna il pageId
   */
  getPageId() {
    return this._page_id_child || this._page_id;
  }
  /**
   * Funzione per settare l'id della modale e/o contenuto che si sovrappone alla pagina in cui ci si trova
   *
   * @param pageId  Page id della pagina caricata
   *
   * @return        Ritorna l'istanza del service
   */
  setPageIdForChild(pageId) {
    if (!pageId) return this;
    this._page_id_child = pageId;
    return this;
  }
  /**
   * Funzione per resettare il pageId della pagina in uscita dalla modale
   *
   * @return        Ritorna l'istanza del service
   */
  closePageIdForChild() {
    this._page_id_child = null;
    return this;
  }
  /**
   * Funzione per resettare lo stato della page_id
   *
   * @return        Ritorna l'istanza del service
   */
  resetPageId() {
    this._page_id = null;
    this._page_id_child = null;
    return this;
  }
  /**
   * Funzione per definire il punto da cui si proviene per la successiva azione view
   *
   * @param from    Sezione della pagina di provenienza
   */
  setNavigatedFrom(from) {
    if (!from) return;
    this._navigatedFrom = from;
  }
}
TealiumUtagService.ɵfac = function TealiumUtagService_Factory(t) {
  return new (t || TealiumUtagService)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵinject"](_bper_npm_core_user_data__WEBPACK_IMPORTED_MODULE_1__.UserDataService), _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵinject"](TEALIUM_INIT_CFG));
};
TealiumUtagService.ɵprov = /* @__PURE__ */_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineInjectable"]({
  token: TealiumUtagService,
  factory: TealiumUtagService.ɵfac
});
(function () {
  (typeof ngDevMode === "undefined" || ngDevMode) && _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵsetClassMetadata"](TealiumUtagService, [{
    type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Injectable
  }], function () {
    return [{
      type: _bper_npm_core_user_data__WEBPACK_IMPORTED_MODULE_1__.UserDataService
    }, {
      type: undefined,
      decorators: [{
        type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Inject,
        args: [TEALIUM_INIT_CFG]
      }]
    }];
  }, null);
})();
const MULTIPLE_IMPORTS_ERROR = 'TealiumUtagModule is already loaded. Import it in the AppModule using the forRoot method';
class TealiumUtagModule {
  constructor(parentModule) {
    if (parentModule) {
      throw new Error(MULTIPLE_IMPORTS_ERROR);
    }
  }
  static forRoot({
    scriptSrc,
    isProduction
  }) {
    return {
      ngModule: TealiumUtagModule,
      providers: [{
        provide: TEALIUM_INIT_CFG,
        useValue: {
          scriptSrc,
          isProduction
        }
      }, TealiumUtagService]
    };
  }
}
TealiumUtagModule.ɵfac = function TealiumUtagModule_Factory(t) {
  return new (t || TealiumUtagModule)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵinject"](TealiumUtagModule, 12));
};
TealiumUtagModule.ɵmod = /* @__PURE__ */_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineNgModule"]({
  type: TealiumUtagModule
});
TealiumUtagModule.ɵinj = /* @__PURE__ */_angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵɵdefineInjector"]({});
(function () {
  (typeof ngDevMode === "undefined" || ngDevMode) && _angular_core__WEBPACK_IMPORTED_MODULE_0__["ɵsetClassMetadata"](TealiumUtagModule, [{
    type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.NgModule,
    args: [{
      imports: []
    }]
  }], function () {
    return [{
      type: TealiumUtagModule,
      decorators: [{
        type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.Optional
      }, {
        type: _angular_core__WEBPACK_IMPORTED_MODULE_0__.SkipSelf
      }]
    }];
  }, null);
})();

/**
 * Generated bundle index. Do not edit.
 */



/***/ })

}])
//# sourceMappingURL=node_modules_bper_npm-core_fesm2020_bper-npm-core-tealium-utag_mjs-_d5241.js.map