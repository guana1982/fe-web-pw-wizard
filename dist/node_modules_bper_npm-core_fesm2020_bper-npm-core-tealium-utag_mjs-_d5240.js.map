{"version":3,"file":"node_modules_bper_npm-core_fesm2020_bper-npm-core-tealium-utag_mjs-_d5240.js","mappings":"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","sources":["./node_modules/@bper/npm-core/fesm2020/bper-npm-core-tealium-utag.mjs"],"sourcesContent":["import * as i0 from '@angular/core';\nimport { InjectionToken, Injectable, Inject, NgModule, Optional, SkipSelf } from '@angular/core';\nimport * as i1 from '@bper/npm-core/user-data';\n\nconst TEALIUM_INIT_CFG = new InjectionToken('Init configuration for tealium service');\n\nconst DEFAULT_FROM_PARAM = 'body';\nclass TealiumUtagService {\n    // Typically set \"noview\" flag (no first page automatic view event) to true for Single Page Apps (SPAs)\n    constructor(_userDataService, cfg) {\n        this._userDataService = _userDataService;\n        /** property per definire la provenienza per l'accesso in pagina. Resettato al lancio della funzione view */\n        this._navigatedFrom = DEFAULT_FROM_PARAM;\n        this._scriptSrc = cfg.scriptSrc;\n        this._isProduction = cfg.isProduction;\n        window.utag_cfg_ovrd = { noview: true };\n        window.utag_data = {};\n    }\n    // Generic script loader with callback\n    _getScript(src, callback) {\n        const d = document;\n        const fn = () => { };\n        const o = { callback: callback || fn };\n        let s;\n        let t;\n        if (typeof src === 'undefined') {\n            return;\n        }\n        s = d.createElement('script');\n        s.language = 'javascript';\n        s.type = 'text/javascript';\n        s.async = 1;\n        s.charset = 'utf-8';\n        s.src = src;\n        if (typeof o.callback === 'function') {\n            if (d.addEventListener) {\n                s.addEventListener('load', () => {\n                    o.callback();\n                }, false);\n            }\n            else {\n                // old IE support\n                s.onreadystatechange = function () {\n                    if (this.readyState === 'complete' ||\n                        this.readyState === 'loaded') {\n                        this.onreadystatechange = null;\n                        o.callback();\n                    }\n                };\n            }\n        }\n        t = d.getElementsByTagName('script')[0];\n        t.parentNode.insertBefore(s, t);\n    }\n    _track(tealiumEvent, data) {\n        if (this._scriptSrc === '') {\n            console.error('[TEALIUM] Config not set.');\n            return;\n        }\n        if (!this._page_id) {\n            console.error('[TEALIUM] Page id not set.');\n            return;\n        }\n        const obj = {\n            ...data,\n            page_id: data?.page_id || this._page_id_child || this._page_id,\n        };\n        if (!this._isProduction) {\n            console.log('[TEALIUM::ACTION] - ', `${tealiumEvent}::${JSON.stringify(obj)}`);\n            return;\n        }\n        if (window.utag === undefined) {\n            this._getScript(this._scriptSrc, () => {\n                window.utag[tealiumEvent](obj);\n            });\n        }\n        else {\n            window.utag[tealiumEvent](obj);\n        }\n    }\n    /**\n     *    Funzione per tracciamento data layer/pagine visitate\n     *\n     *      @param data: UTagViewDataModel\n     */\n    view(data) {\n        try {\n            const utente_codice_hb = this._userDataService.userData?.homeBankingAccountCode || '';\n            const utente_pacchetto = this._userDataService.userProduct?.code || '';\n            const utente_abi_banca = this._userDataService.userData?.abi || '05387';\n            const from = this._navigatedFrom;\n            this._track('view', {\n                ...data,\n                utente_abi_banca,\n                utente_codice_hb,\n                utente_pacchetto,\n                from,\n            });\n            /** Reset from dopo l'azione di view */\n            this._navigatedFrom = DEFAULT_FROM_PARAM;\n        }\n        catch (err) {\n            console.error(err);\n            throw new Error('[TEALIUM::ERROR] Data view not valid');\n        }\n    }\n    /**\n     *    Funzione per tracciamento eventi\n     *\n     *      @param data: UTagLinkDataModel\n     */\n    link(data) {\n        if (!data)\n            return;\n        try {\n            this._track('link', { ...data });\n        }\n        catch (err) {\n            console.error(err);\n            throw new Error('[TEALIUM][ERROR] link');\n        }\n    }\n    /**\n     * Funzione per settare l'id della pagina in cui ci si trova\n     *\n     * @param pageId  Page id della pagina caricata\n     *\n     * @return        Ritorna l'istanza del service\n     */\n    setPageId(pageId) {\n        this._page_id = pageId;\n        return this;\n    }\n    /**\n     * Funzione per recuperare l'id della pagina in cui ci si trova\n     *\n     * @return        Ritorna il pageId\n     */\n    getPageId() {\n        return this._page_id_child || this._page_id;\n    }\n    /**\n     * Funzione per settare l'id della modale e/o contenuto che si sovrappone alla pagina in cui ci si trova\n     *\n     * @param pageId  Page id della pagina caricata\n     *\n     * @return        Ritorna l'istanza del service\n     */\n    setPageIdForChild(pageId) {\n        if (!pageId)\n            return this;\n        this._page_id_child = pageId;\n        return this;\n    }\n    /**\n     * Funzione per resettare il pageId della pagina in uscita dalla modale\n     *\n     * @return        Ritorna l'istanza del service\n     */\n    closePageIdForChild() {\n        this._page_id_child = null;\n        return this;\n    }\n    /**\n     * Funzione per resettare lo stato della page_id\n     *\n     * @return        Ritorna l'istanza del service\n     */\n    resetPageId() {\n        this._page_id = null;\n        this._page_id_child = null;\n        return this;\n    }\n    /**\n     * Funzione per definire il punto da cui si proviene per la successiva azione view\n     *\n     * @param from    Sezione della pagina di provenienza\n     */\n    setNavigatedFrom(from) {\n        if (!from)\n            return;\n        this._navigatedFrom = from;\n    }\n}\nTealiumUtagService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"14.3.0\", ngImport: i0, type: TealiumUtagService, deps: [{ token: i1.UserDataService }, { token: TEALIUM_INIT_CFG }], target: i0.ɵɵFactoryTarget.Injectable });\nTealiumUtagService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"14.3.0\", ngImport: i0, type: TealiumUtagService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"14.3.0\", ngImport: i0, type: TealiumUtagService, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: i1.UserDataService }, { type: undefined, decorators: [{\n                    type: Inject,\n                    args: [TEALIUM_INIT_CFG]\n                }] }]; } });\n\nconst MULTIPLE_IMPORTS_ERROR = 'TealiumUtagModule is already loaded. Import it in the AppModule using the forRoot method';\nclass TealiumUtagModule {\n    constructor(parentModule) {\n        if (parentModule) {\n            throw new Error(MULTIPLE_IMPORTS_ERROR);\n        }\n    }\n    static forRoot({ scriptSrc, isProduction }) {\n        return {\n            ngModule: TealiumUtagModule,\n            providers: [\n                {\n                    provide: TEALIUM_INIT_CFG,\n                    useValue: { scriptSrc, isProduction }\n                },\n                TealiumUtagService\n            ]\n        };\n    }\n}\nTealiumUtagModule.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"14.3.0\", ngImport: i0, type: TealiumUtagModule, deps: [{ token: TealiumUtagModule, optional: true, skipSelf: true }], target: i0.ɵɵFactoryTarget.NgModule });\nTealiumUtagModule.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: \"14.0.0\", version: \"14.3.0\", ngImport: i0, type: TealiumUtagModule });\nTealiumUtagModule.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: \"12.0.0\", version: \"14.3.0\", ngImport: i0, type: TealiumUtagModule });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"14.3.0\", ngImport: i0, type: TealiumUtagModule, decorators: [{\n            type: NgModule,\n            args: [{\n                    imports: []\n                }]\n        }], ctorParameters: function () { return [{ type: TealiumUtagModule, decorators: [{\n                    type: Optional\n                }, {\n                    type: SkipSelf\n                }] }]; } });\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { TEALIUM_INIT_CFG, TealiumUtagModule, TealiumUtagService };\n"],"names":["i0","InjectionToken","Injectable","Inject","NgModule","Optional","SkipSelf","i1","TEALIUM_INIT_CFG","DEFAULT_FROM_PARAM","TealiumUtagService","constructor","_userDataService","cfg","_navigatedFrom","_scriptSrc","scriptSrc","_isProduction","isProduction","window","utag_cfg_ovrd","noview","utag_data","_getScript","src","callback","d","document","fn","o","s","t","createElement","language","type","async","charset","addEventListener","onreadystatechange","readyState","getElementsByTagName","parentNode","insertBefore","_track","tealiumEvent","data","console","error","_page_id","obj","page_id","_page_id_child","log","JSON","stringify","utag","undefined","view","utente_codice_hb","userData","homeBankingAccountCode","utente_pacchetto","userProduct","code","utente_abi_banca","abi","from","err","Error","link","setPageId","pageId","getPageId","setPageIdForChild","closePageIdForChild","resetPageId","setNavigatedFrom","ɵfac","TealiumUtagService_Factory","ɵɵinject","UserDataService","ɵprov","ɵɵdefineInjectable","token","factory","ngDevMode","ɵsetClassMetadata","decorators","args","MULTIPLE_IMPORTS_ERROR","TealiumUtagModule","parentModule","forRoot","ngModule","providers","provide","useValue","TealiumUtagModule_Factory","ɵmod","ɵɵdefineNgModule","ɵinj","ɵɵdefineInjector","imports"],"sourceRoot":"webpack:///","x_google_ignoreList":[0]}